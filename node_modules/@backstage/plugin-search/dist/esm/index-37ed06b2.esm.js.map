{"version":3,"file":"index-37ed06b2.esm.js","sources":["../../src/apis.ts","../../src/components/SearchBar/SearchBar.tsx","../../src/components/Filters/FiltersButton.tsx","../../src/components/Filters/Filters.tsx","../../src/components/SearchResult/SearchResult.tsx","../../src/components/SearchPage/SearchPage.tsx","../../src/components/SearchPageNext/SearchPageNext.tsx","../../src/plugin.ts","../../src/components/SidebarSearch/SidebarSearch.tsx"],"sourcesContent":["/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createApiRef, DiscoveryApi } from '@backstage/core';\nimport { Entity, ENTITY_DEFAULT_NAMESPACE } from '@backstage/catalog-model';\n\nimport { CatalogApi } from '@backstage/plugin-catalog-react';\nimport { SearchQuery, SearchResultSet } from '@backstage/search-common';\nimport qs from 'qs';\n\nexport const searchApiRef = createApiRef<SearchApi>({\n  id: 'plugin.search.queryservice',\n  description: 'Used to make requests against the search API',\n});\n\nexport type Result = {\n  name: string;\n  description: string | undefined;\n  owner: string | undefined;\n  kind: string;\n  lifecycle: string | undefined;\n  url: string;\n};\n\nexport type SearchResults = Array<Result>;\n\nexport interface SearchApi {\n  getSearchResult(): Promise<SearchResults>;\n  _alphaPerformSearch(query: SearchQuery): Promise<SearchResultSet>;\n}\n\nexport class SearchClient implements SearchApi {\n  private readonly catalogApi: CatalogApi;\n  private readonly discoveryApi: DiscoveryApi;\n\n  constructor(options: { catalogApi: CatalogApi; discoveryApi: DiscoveryApi }) {\n    this.catalogApi = options.catalogApi;\n    this.discoveryApi = options.discoveryApi;\n  }\n\n  private async entities() {\n    const entities = await this.catalogApi.getEntities();\n    return entities.items.map((entity: Entity) => ({\n      name: entity.metadata.name,\n      description: entity.metadata.description,\n      owner:\n        typeof entity.spec?.owner === 'string' ? entity.spec?.owner : undefined,\n      kind: entity.kind,\n      lifecycle:\n        typeof entity.spec?.lifecycle === 'string'\n          ? entity.spec?.lifecycle\n          : undefined,\n      url: `/catalog/${\n        entity.metadata.namespace?.toLowerCase() || ENTITY_DEFAULT_NAMESPACE\n      }/${entity.kind.toLowerCase()}/${entity.metadata.name}`,\n    }));\n  }\n\n  getSearchResult(): Promise<SearchResults> {\n    return this.entities();\n  }\n\n  // TODO: Productionalize as we implement search milestones.\n  async _alphaPerformSearch(query: SearchQuery): Promise<SearchResultSet> {\n    const queryString = qs.stringify(query);\n    const url = `${await this.discoveryApi.getBaseUrl(\n      'search/query',\n    )}?${queryString}`;\n    const response = await fetch(url);\n    return response.json();\n  }\n}\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Paper } from '@material-ui/core';\nimport InputBase from '@material-ui/core/InputBase';\nimport IconButton from '@material-ui/core/IconButton';\nimport SearchIcon from '@material-ui/icons/Search';\nimport ClearButton from '@material-ui/icons/Clear';\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n  },\n  input: {\n    flex: 1,\n  },\n}));\n\ntype SearchBarProps = {\n  searchQuery: string;\n  handleSearch: any;\n  handleClearSearchBar: any;\n};\n\nexport const SearchBar = ({\n  searchQuery,\n  handleSearch,\n  handleClearSearchBar,\n}: SearchBarProps) => {\n  const classes = useStyles();\n\n  return (\n    <Paper\n      component=\"form\"\n      onSubmit={e => handleSearch(e)}\n      className={classes.root}\n    >\n      <IconButton disabled type=\"submit\" aria-label=\"search\">\n        <SearchIcon />\n      </IconButton>\n      <InputBase\n        className={classes.input}\n        placeholder=\"Search in Backstage\"\n        value={searchQuery}\n        onChange={e => handleSearch(e)}\n        inputProps={{ 'aria-label': 'search backstage' }}\n      />\n      <IconButton aria-label=\"search\" onClick={() => handleClearSearchBar()}>\n        <ClearButton />\n      </IconButton>\n    </Paper>\n  );\n};\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport { makeStyles, IconButton, Typography } from '@material-ui/core';\n\nconst useStyles = makeStyles(theme => ({\n  filters: {\n    width: '250px',\n    display: 'flex',\n  },\n  icon: {\n    margin: theme.spacing(-1, 0, 0, 0),\n  },\n}));\n\ntype FiltersButtonProps = {\n  numberOfSelectedFilters: number;\n  handleToggleFilters: () => void;\n};\n\nexport const FiltersButton = ({\n  numberOfSelectedFilters,\n  handleToggleFilters,\n}: FiltersButtonProps) => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.filters}>\n      <IconButton\n        className={classes.icon}\n        aria-label=\"settings\"\n        onClick={handleToggleFilters}\n      >\n        <FilterListIcon />\n      </IconButton>\n      <Typography variant=\"h6\">\n        Filters ({numberOfSelectedFilters ? numberOfSelectedFilters : 0})\n      </Typography>\n    </div>\n  );\n};\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {\n  makeStyles,\n  Typography,\n  Divider,\n  Card,\n  CardHeader,\n  Button,\n  CardContent,\n  Select,\n  Checkbox,\n  List,\n  ListItem,\n  ListItemText,\n  MenuItem,\n} from '@material-ui/core';\n\nconst useStyles = makeStyles(theme => ({\n  filters: {\n    background: 'transparent',\n    boxShadow: '0px 0px 0px 0px',\n  },\n  checkbox: {\n    padding: theme.spacing(0, 1, 0, 1),\n  },\n  dropdown: {\n    width: '100%',\n  },\n}));\n\nexport type FiltersState = {\n  selected: string;\n  checked: Array<string>;\n};\n\nexport type FilterOptions = {\n  kind: Array<string>;\n  lifecycle: Array<string>;\n};\n\ntype FiltersProps = {\n  filters: FiltersState;\n  filterOptions: FilterOptions;\n  resetFilters: () => void;\n  updateSelected: (filter: string) => void;\n  updateChecked: (filter: string) => void;\n};\n\nexport const Filters = ({\n  filters,\n  filterOptions,\n  resetFilters,\n  updateSelected,\n  updateChecked,\n}: FiltersProps) => {\n  const classes = useStyles();\n\n  return (\n    <Card className={classes.filters}>\n      <CardHeader\n        title={<Typography variant=\"h6\">Filters</Typography>}\n        action={\n          <Button color=\"primary\" onClick={() => resetFilters()}>\n            CLEAR ALL\n          </Button>\n        }\n      />\n      <Divider />\n      {filterOptions.kind.length === 0 && filterOptions.lifecycle.length === 0 && (\n        <CardContent>\n          <Typography variant=\"subtitle2\">\n            Filters cannot be applied to available results\n          </Typography>\n        </CardContent>\n      )}\n      {filterOptions.kind.length > 0 && (\n        <CardContent>\n          <Typography variant=\"subtitle2\">Kind</Typography>\n          <Select\n            id=\"outlined-select\"\n            onChange={(e: React.ChangeEvent<any>) =>\n              updateSelected(e?.target?.value)\n            }\n            variant=\"outlined\"\n            className={classes.dropdown}\n            value={filters.selected}\n          >\n            {filterOptions.kind.map(filter => (\n              <MenuItem\n                selected={filter === ''}\n                dense\n                key={filter}\n                value={filter}\n              >\n                {filter}\n              </MenuItem>\n            ))}\n          </Select>\n        </CardContent>\n      )}\n      {filterOptions.lifecycle.length > 0 && (\n        <CardContent>\n          <Typography variant=\"subtitle2\">Lifecycle</Typography>\n          <List disablePadding dense>\n            {filterOptions.lifecycle.map(filter => (\n              <ListItem\n                key={filter}\n                dense\n                button\n                onClick={() => updateChecked(filter)}\n              >\n                <Checkbox\n                  edge=\"start\"\n                  disableRipple\n                  className={classes.checkbox}\n                  color=\"primary\"\n                  checked={filters.checked.includes(filter)}\n                  tabIndex={-1}\n                  value={filter}\n                  name={filter}\n                />\n                <ListItemText id={filter} primary={filter} />\n              </ListItem>\n            ))}\n          </List>\n        </CardContent>\n      )}\n    </Card>\n  );\n};\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  EmptyState,\n  Link,\n  Progress,\n  Table,\n  TableColumn,\n  useApi,\n} from '@backstage/core';\nimport { Divider, Grid, makeStyles, Typography } from '@material-ui/core';\nimport { Alert } from '@material-ui/lab';\nimport React, { useEffect, useState } from 'react';\nimport { useAsync } from 'react-use';\nimport { Result, SearchResults, searchApiRef } from '../../apis';\n\nimport { Filters, FiltersButton, FiltersState } from '../Filters';\n\nconst useStyles = makeStyles(theme => ({\n  searchQuery: {\n    color: theme.palette.text.primary,\n    background: theme.palette.background.default,\n    borderRadius: '10%',\n  },\n  tableHeader: {\n    margin: theme.spacing(1, 0, 0, 0),\n    display: 'flex',\n  },\n  divider: {\n    width: '1px',\n    margin: theme.spacing(0, 2),\n    padding: theme.spacing(2, 0),\n  },\n}));\n\ntype SearchResultProps = {\n  searchQuery?: string;\n};\n\ntype TableHeaderProps = {\n  searchQuery?: string;\n  numberOfSelectedFilters: number;\n  numberOfResults: number;\n  handleToggleFilters: () => void;\n};\n\n// TODO: move out column to make the search result component more generic\nconst columns: TableColumn[] = [\n  {\n    title: 'Name',\n    field: 'name',\n    highlight: true,\n    render: (result: Partial<Result>) => (\n      <Link to={result.url || ''}>{result.name}</Link>\n    ),\n  },\n  {\n    title: 'Description',\n    field: 'description',\n  },\n  {\n    title: 'Owner',\n    field: 'owner',\n  },\n  {\n    title: 'Kind',\n    field: 'kind',\n  },\n  {\n    title: 'LifeCycle',\n    field: 'lifecycle',\n  },\n];\n\nconst TableHeader = ({\n  searchQuery,\n  numberOfSelectedFilters,\n  numberOfResults,\n  handleToggleFilters,\n}: TableHeaderProps) => {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.tableHeader}>\n      <FiltersButton\n        numberOfSelectedFilters={numberOfSelectedFilters}\n        handleToggleFilters={handleToggleFilters}\n      />\n      <Divider className={classes.divider} orientation=\"vertical\" />\n      <Grid item xs={12}>\n        {searchQuery ? (\n          <Typography variant=\"h6\">\n            {`${numberOfResults} `}\n            {numberOfResults > 1 ? `results for ` : `result for `}\n            <span className={classes.searchQuery}>\"{searchQuery}\"</span>{' '}\n          </Typography>\n        ) : (\n          <Typography variant=\"h6\">{`${numberOfResults} results`}</Typography>\n        )}\n      </Grid>\n    </div>\n  );\n};\n\nexport const SearchResult = ({ searchQuery }: SearchResultProps) => {\n  const searchApi = useApi(searchApiRef);\n\n  const [showFilters, toggleFilters] = useState(false);\n  const [selectedFilters, setSelectedFilters] = useState<FiltersState>({\n    selected: '',\n    checked: [],\n  });\n\n  const [filteredResults, setFilteredResults] = useState<SearchResults>([]);\n\n  const { loading, error, value: results } = useAsync(() => {\n    return searchApi.getSearchResult();\n  }, []);\n\n  useEffect(() => {\n    if (results) {\n      let withFilters = results;\n\n      // apply filters\n\n      // filter on selected\n      if (selectedFilters.selected !== '') {\n        withFilters = results.filter((result: Result) =>\n          selectedFilters.selected.includes(result.kind),\n        );\n      }\n\n      // filter on checked\n      if (selectedFilters.checked.length > 0) {\n        withFilters = withFilters.filter(\n          (result: Result) =>\n            result.lifecycle &&\n            selectedFilters.checked.includes(result.lifecycle),\n        );\n      }\n\n      // filter on searchQuery\n      if (searchQuery) {\n        withFilters = withFilters.filter(\n          (result: Result) =>\n            result.name?.toLocaleLowerCase('en-US').includes(searchQuery) ||\n            result.name\n              ?.toLocaleLowerCase('en-US')\n              .includes(searchQuery.split(' ').join('-')) ||\n            result.description\n              ?.toLocaleLowerCase('en-US')\n              .includes(searchQuery),\n        );\n      }\n\n      setFilteredResults(withFilters);\n    }\n  }, [selectedFilters, searchQuery, results]);\n  if (loading) {\n    return <Progress />;\n  }\n  if (error) {\n    return (\n      <Alert severity=\"error\">\n        Error encountered while fetching search results. {error.toString()}\n      </Alert>\n    );\n  }\n  if (!results || results.length === 0) {\n    return <EmptyState missing=\"data\" title=\"Sorry, no results were found\" />;\n  }\n\n  const resetFilters = () => {\n    setSelectedFilters({\n      selected: '',\n      checked: [],\n    });\n  };\n\n  const updateSelected = (filter: string) => {\n    setSelectedFilters(prevState => ({\n      ...prevState,\n      selected: filter,\n    }));\n  };\n\n  const updateChecked = (filter: string) => {\n    if (selectedFilters.checked.includes(filter)) {\n      setSelectedFilters(prevState => ({\n        ...prevState,\n        checked: prevState.checked.filter(item => item !== filter),\n      }));\n      return;\n    }\n\n    setSelectedFilters(prevState => ({\n      ...prevState,\n      checked: [...prevState.checked, filter],\n    }));\n  };\n\n  const filterOptions = results.reduce(\n    (acc, curr) => {\n      if (curr.kind && acc.kind.indexOf(curr.kind) < 0) {\n        acc.kind.push(curr.kind);\n      }\n      if (curr.lifecycle && acc.lifecycle.indexOf(curr.lifecycle) < 0) {\n        acc.lifecycle.push(curr.lifecycle);\n      }\n      return acc;\n    },\n    {\n      kind: [] as Array<string>,\n      lifecycle: [] as Array<string>,\n    },\n  );\n\n  return (\n    <>\n      <Grid container>\n        {showFilters && (\n          <Grid item xs={3}>\n            <Filters\n              filters={selectedFilters}\n              filterOptions={filterOptions}\n              resetFilters={resetFilters}\n              updateSelected={updateSelected}\n              updateChecked={updateChecked}\n            />\n          </Grid>\n        )}\n        <Grid item xs={showFilters ? 9 : 12}>\n          <Table\n            options={{ paging: true, pageSize: 20, search: false }}\n            data={filteredResults}\n            columns={columns}\n            title={\n              <TableHeader\n                searchQuery={searchQuery}\n                numberOfResults={filteredResults.length}\n                numberOfSelectedFilters={\n                  (selectedFilters.selected !== '' ? 1 : 0) +\n                  selectedFilters.checked.length\n                }\n                handleToggleFilters={() => toggleFilters(!showFilters)}\n              />\n            }\n          />\n        </Grid>\n      </Grid>\n    </>\n  );\n};\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Content, Header, Page, useQueryParamState } from '@backstage/core';\nimport { Grid } from '@material-ui/core';\nimport React, { useEffect, useState } from 'react';\nimport { useDebounce } from 'react-use';\nimport { SearchBar } from '../SearchBar';\nimport { SearchResult } from '../SearchResult';\n\nexport const SearchPage = () => {\n  const [queryString, setQueryString] = useQueryParamState<string>('query');\n  const [searchQuery, setSearchQuery] = useState(queryString ?? '');\n\n  const handleSearch = (event: React.ChangeEvent<HTMLInputElement>) => {\n    event.preventDefault();\n    setSearchQuery(event.target.value);\n  };\n\n  useEffect(() => setSearchQuery(queryString ?? ''), [queryString]);\n\n  useDebounce(\n    () => {\n      setQueryString(searchQuery);\n    },\n    200,\n    [searchQuery],\n  );\n\n  const handleClearSearchBar = () => {\n    setSearchQuery('');\n  };\n\n  return (\n    <Page themeId=\"home\">\n      <Header title=\"Search\" />\n      <Content>\n        <Grid container direction=\"row\">\n          <Grid item xs={12}>\n            <SearchBar\n              handleSearch={handleSearch}\n              handleClearSearchBar={handleClearSearchBar}\n              searchQuery={searchQuery}\n            />\n          </Grid>\n          <Grid item xs={12}>\n            <SearchResult\n              searchQuery={(queryString ?? '').toLocaleLowerCase('en-US')}\n            />\n          </Grid>\n        </Grid>\n      </Content>\n    </Page>\n  );\n};\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  Content,\n  Header,\n  Lifecycle,\n  Page,\n  useQueryParamState,\n} from '@backstage/core';\nimport { Grid } from '@material-ui/core';\nimport React, { useEffect, useState } from 'react';\nimport { useDebounce } from 'react-use';\nimport { SearchBar } from '../SearchBar';\nimport { SearchResult } from '../SearchResult';\n\nexport const SearchPageNext = () => {\n  const [queryString, setQueryString] = useQueryParamState<string>('query');\n  const [searchQuery, setSearchQuery] = useState(queryString ?? '');\n\n  const handleSearch = (event: React.ChangeEvent<HTMLInputElement>) => {\n    event.preventDefault();\n    setSearchQuery(event.target.value);\n  };\n\n  useEffect(() => setSearchQuery(queryString ?? ''), [queryString]);\n\n  useDebounce(\n    () => {\n      setQueryString(searchQuery);\n    },\n    200,\n    [searchQuery],\n  );\n\n  const handleClearSearchBar = () => {\n    setSearchQuery('');\n  };\n\n  return (\n    <Page themeId=\"home\">\n      <Header title=\"Search\" subtitle={<Lifecycle alpha />} />\n      <Content>\n        <Grid container direction=\"row\">\n          <Grid item xs={12}>\n            <SearchBar\n              handleSearch={handleSearch}\n              handleClearSearchBar={handleClearSearchBar}\n              searchQuery={searchQuery}\n            />\n          </Grid>\n          <Grid item xs={12}>\n            <SearchResult searchQuery={(queryString ?? '').toLowerCase()} />\n          </Grid>\n        </Grid>\n      </Content>\n    </Page>\n  );\n};\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  createApiFactory,\n  createPlugin,\n  createRouteRef,\n  createRoutableExtension,\n  discoveryApiRef,\n} from '@backstage/core';\nimport { SearchClient, searchApiRef } from './apis';\nimport { catalogApiRef } from '@backstage/plugin-catalog-react';\nimport { SearchPage as SearchPageComponent } from './components/SearchPage';\nimport { SearchPageNext as SearchPageNextComponent } from './components/SearchPageNext';\n\nexport const rootRouteRef = createRouteRef({\n  path: '/search',\n  title: 'search',\n});\n\nexport const rootNextRouteRef = createRouteRef({\n  path: '/search-next',\n  title: 'search',\n});\n\nexport const searchPlugin = createPlugin({\n  id: 'search',\n  apis: [\n    createApiFactory({\n      api: searchApiRef,\n      deps: { catalogApi: catalogApiRef, discoveryApi: discoveryApiRef },\n      factory: ({ catalogApi, discoveryApi }) => {\n        return new SearchClient({ catalogApi, discoveryApi });\n      },\n    }),\n  ],\n  register({ router }) {\n    router.addRoute(rootRouteRef, SearchPageComponent);\n    router.addRoute(rootNextRouteRef, SearchPageNextComponent);\n  },\n  routes: {\n    root: rootRouteRef,\n    nextRoot: rootNextRouteRef,\n  },\n});\n\nexport const SearchPage = searchPlugin.provide(\n  createRoutableExtension({\n    component: () => import('./components/SearchPage').then(m => m.SearchPage),\n    mountPoint: rootRouteRef,\n  }),\n);\n\nexport const SearchPageNext = searchPlugin.provide(\n  createRoutableExtension({\n    component: () =>\n      import('./components/SearchPageNext').then(m => m.SearchPageNext),\n    mountPoint: rootNextRouteRef,\n  }),\n);\n","/*\n * Copyright 2020 Spotify AB\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { SidebarSearchField, useRouteRef } from '@backstage/core';\nimport qs from 'qs';\nimport React, { useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { rootRouteRef } from '../../plugin';\n\nexport const SidebarSearch = () => {\n  const searchRoute = useRouteRef(rootRouteRef);\n  const navigate = useNavigate();\n  const handleSearch = useCallback(\n    (query: string): void => {\n      const queryString = qs.stringify({ query }, { addQueryPrefix: true });\n\n      navigate(`${searchRoute()}${queryString}`);\n    },\n    [navigate, searchRoute],\n  );\n\n  return <SidebarSearchField onSearch={handleSearch} to=\"/search\" />;\n};\n"],"names":["useStyles","makeStyles","IconButton","SearchPageComponent","SearchPageNextComponent","SearchPage","SearchPageNext"],"mappings":"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"}