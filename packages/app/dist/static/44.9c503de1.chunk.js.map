{"version":3,"sources":["webpack:////Users/udanam/swift/backstage/demo-app/node_modules/@backstage/plugin-catalog/dist/esm/index-d159831b.esm.js","webpack:////Users/udanam/swift/backstage/demo-app/node_modules/@material-ui/icons/ZoomOutMap.js"],"names":["useStyles","theme","domainNode","fill","palette","primary","main","stroke","border","systemNode","componentNode","apiNode","gold","resourceNode","readableEntityName","ref","toLocaleLowerCase","replace","split","RenderNode","props","classes","catalogEntityRoute","kind","node","id","nodeClass","createElement","width","height","rx","className","to","namespace","name","x","y","textAnchor","alignmentBaseline","style","fontWeight","SystemDiagramCard","entity","currentSystemName","metadata","currentSystemNode","systemNodes","Array","systemEdges","catalogApi","loading","error","value","catalogResponse","getEntities","filter","push","catalogItemDomain","forEach","foundDomain","from","label","items","catalogItem","foundRelation","title","nodes","edges","nodeMargin","direction","Direction","BOTTOM_TOP","renderNode","m","variant","display","textAlign","verticalAlign","_interopRequireDefault","_interopRequireWildcard","Object","defineProperty","exports","default","React","_default","d"],"mappings":"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","file":"static/44.9c503de1.chunk.js","sourcesContent":["import { stringifyEntityRef, ENTITY_DEFAULT_NAMESPACE, RELATION_PART_OF, RELATION_PROVIDES_API, RELATION_DEPENDS_ON, parseEntityRef } from '@backstage/catalog-model';\nimport { useApi, Progress, ResponseErrorPanel, InfoCard, DependencyGraph, DependencyGraphTypes, useRouteRef, Link } from '@backstage/core';\nimport { useEntity, catalogApiRef, getEntityRelations, entityRouteRef } from '@backstage/plugin-catalog-react';\nimport { makeStyles, Box, Typography } from '@material-ui/core';\nimport React from 'react';\nimport { useAsync } from 'react-use';\nimport ZoomOutMap from '@material-ui/icons/ZoomOutMap';\n\nconst useStyles = makeStyles((theme) => ({\n  domainNode: {\n    fill: theme.palette.primary.main,\n    stroke: theme.palette.border\n  },\n  systemNode: {\n    fill: \"coral\",\n    stroke: theme.palette.border\n  },\n  componentNode: {\n    fill: \"yellowgreen\",\n    stroke: theme.palette.border\n  },\n  apiNode: {\n    fill: theme.palette.gold,\n    stroke: theme.palette.border\n  },\n  resourceNode: {\n    fill: \"grey\",\n    stroke: theme.palette.border\n  }\n}));\nfunction readableEntityName(ref) {\n  return stringifyEntityRef(ref).toLocaleLowerCase(\"en-US\").replace(`:${ENTITY_DEFAULT_NAMESPACE}/`, \":\").split(\":\")[1];\n}\nfunction RenderNode(props) {\n  const classes = useStyles();\n  const catalogEntityRoute = useRouteRef(entityRouteRef);\n  const kind = props.node.kind || \"Component\";\n  const ref = parseEntityRef(props.node.id);\n  let nodeClass = classes.componentNode;\n  switch (kind) {\n    case \"Domain\":\n      nodeClass = classes.domainNode;\n      break;\n    case \"System\":\n      nodeClass = classes.systemNode;\n      break;\n    case \"Component\":\n      nodeClass = classes.componentNode;\n      break;\n    case \"API\":\n      nodeClass = classes.apiNode;\n      break;\n    case \"Resource\":\n      nodeClass = classes.resourceNode;\n      break;\n    default:\n      nodeClass = classes.componentNode;\n  }\n  return /* @__PURE__ */ React.createElement(\"g\", null, /* @__PURE__ */ React.createElement(\"rect\", {\n    width: 200,\n    height: 100,\n    rx: 20,\n    className: nodeClass\n  }), /* @__PURE__ */ React.createElement(Link, {\n    to: catalogEntityRoute({\n      kind,\n      namespace: ref.namespace,\n      name: ref.name\n    })\n  }, /* @__PURE__ */ React.createElement(\"text\", {\n    x: 100,\n    y: 45,\n    textAnchor: \"middle\",\n    alignmentBaseline: \"baseline\",\n    style: {fontWeight: \"bold\"}\n  }, props.node.name)), /* @__PURE__ */ React.createElement(\"text\", {\n    x: 100,\n    y: 65,\n    textAnchor: \"middle\",\n    alignmentBaseline: \"hanging\"\n  }, props.node.kind));\n}\nfunction SystemDiagramCard() {\n  const {entity} = useEntity();\n  const currentSystemName = entity.metadata.name;\n  const currentSystemNode = stringifyEntityRef(entity);\n  const systemNodes = new Array();\n  const systemEdges = new Array();\n  const catalogApi = useApi(catalogApiRef);\n  const {loading, error, value: catalogResponse} = useAsync(() => {\n    return catalogApi.getEntities({\n      filter: {\n        kind: [\"Component\", \"API\", \"Resource\", \"System\", \"Domain\"],\n        \"spec.system\": [\n          currentSystemName,\n          `${ENTITY_DEFAULT_NAMESPACE}/${currentSystemName}`\n        ]\n      }\n    });\n  }, [catalogApi, currentSystemName]);\n  systemNodes.push({\n    id: currentSystemNode,\n    kind: \"System\",\n    name: readableEntityName(entity)\n  });\n  const catalogItemDomain = getEntityRelations(entity, RELATION_PART_OF, {\n    kind: \"Domain\"\n  });\n  catalogItemDomain.forEach((foundDomain) => systemNodes.push({\n    id: stringifyEntityRef(foundDomain),\n    kind: foundDomain.kind,\n    name: readableEntityName(foundDomain)\n  }));\n  catalogItemDomain.forEach((foundDomain) => systemEdges.push({\n    from: currentSystemNode,\n    to: stringifyEntityRef(foundDomain),\n    label: \"part of\"\n  }));\n  if (catalogResponse && catalogResponse.items) {\n    for (const catalogItem of catalogResponse.items) {\n      systemNodes.push({\n        id: stringifyEntityRef(catalogItem),\n        kind: catalogItem.kind,\n        name: readableEntityName(catalogItem)\n      });\n      const catalogItemRelations_partOf = getEntityRelations(catalogItem, RELATION_PART_OF);\n      catalogItemRelations_partOf.forEach((foundRelation) => systemEdges.push({\n        from: stringifyEntityRef(catalogItem),\n        to: stringifyEntityRef(foundRelation),\n        label: \"part of\"\n      }));\n      const catalogItemRelations_providesApi = getEntityRelations(catalogItem, RELATION_PROVIDES_API);\n      catalogItemRelations_providesApi.forEach((foundRelation) => systemEdges.push({\n        from: stringifyEntityRef(catalogItem),\n        to: stringifyEntityRef(foundRelation),\n        label: \"provides\"\n      }));\n      const catalogItemRelations_dependsOn = getEntityRelations(catalogItem, RELATION_DEPENDS_ON);\n      catalogItemRelations_dependsOn.forEach((foundRelation) => systemEdges.push({\n        from: stringifyEntityRef(catalogItem),\n        to: stringifyEntityRef(foundRelation),\n        label: \"depends on\"\n      }));\n    }\n  }\n  if (loading) {\n    return /* @__PURE__ */ React.createElement(Progress, null);\n  } else if (error) {\n    return /* @__PURE__ */ React.createElement(ResponseErrorPanel, {\n      error\n    });\n  }\n  return /* @__PURE__ */ React.createElement(InfoCard, {\n    title: \"System Diagram\"\n  }, /* @__PURE__ */ React.createElement(DependencyGraph, {\n    nodes: systemNodes,\n    edges: systemEdges,\n    nodeMargin: 10,\n    direction: DependencyGraphTypes.Direction.BOTTOM_TOP,\n    renderNode: RenderNode\n  }), /* @__PURE__ */ React.createElement(Box, {\n    m: 1\n  }), /* @__PURE__ */ React.createElement(Typography, {\n    variant: \"caption\",\n    style: {display: \"block\", textAlign: \"right\"}\n  }, /* @__PURE__ */ React.createElement(ZoomOutMap, {\n    style: {verticalAlign: \"bottom\"}\n  }), \" Use pinch & zoom to move around the diagram.\"));\n}\n\nexport { SystemDiagramCard };\n//# sourceMappingURL=index-d159831b.esm.js.map\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15 3l2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3h-6zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3v6zm6 12l-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6h6zm12-6l-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6v-6z\"\n}), 'ZoomOutMap');\n\nexports.default = _default;"],"sourceRoot":""}